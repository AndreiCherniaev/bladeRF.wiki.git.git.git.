This page provides an overview of the <b>XB-200</b> and provides some information on its use.

= Introduction =

The <b>XB-200 transverter board</b> is a block up-down converter that expands the bladeRFâ€™s lower frequency range, allowing the bladeRF to be used in HF/VHF applications. 

The RX and TX paths each have a set of 3 filters, at the 50MHz-54MHz (6 meter) band, 149MHz-159MHz (2 meter) band, and 206-235MHz (includes 1.25m) bands. There are also pairs of SMA connectors that will let users plug their own band filters into the RF path.

The XB-200 mates to the top of the bladeRF as follows. (There is only one possible orientation)
* XB-200 <b>U20</b> to bladeRF <b>U74</b>
* XB-200 <b>J5</b> to bladeRF <b>J61</b>
* XB-200 <b>J6</b> to bladeRF <b>J60</b>

For additional information, please see:
* [[XB-200 product page|http://www.nuand.com/blog/product/hf-vhf-transverter/]]
* [[XB-200 schematics|http://nuand.com/xb200.pdf]]
* [[XB-200 filter designs|http://nuand.com/RF_filters.pdf]]

= Hardware =

== Architecture ==

The transverter was meant to extend the range of the bladeRF without impairing the current frequency capabilities.  As such, the transverter has a bypass path as well as a mixed path.  The bypass path just connects the antenna port to the IF port directly without any modification to the signal.

The mixed path first has a filterbank for selectivity filtering.  This filterbank consists of 4 separate paths: 50MHz filter, 144MHz filter, 222MHz filter and a custom filter.  The custom filter can be put in line using the filter SMA connections on the transverter.

Each of the filters was designed to try to notch the terrestrial FM band as much as possible.  To be able to receive normal FM, the simplest way is to put an SMA jumper in the custom path (i.e., between the RX/TX <b>FILT</b> and <b>FILT-ANT</b> SMA connectors).

The block converter stage uses an ADF4351 to produce a 1248MHz high-side injection tone.  The mixing frequency was chosen because of it being about 3x higher than the 300MHz highest frequency we want to use and we can run the ADF4351 in integer-N mode, reducing spurs which may have resulted from a fractional-N mode of operation.  The output of the ADF4351 is always divided by 2x, so 38.4MHz*32.5 = 1248MHz.

Since high side injection is used, the LMS6002D on the bladeRF is tuning to 1248MHz - (desired frequency).  Moreover, there is a spectral inversion that is occurring due to the choice of high-side injection.  The LMS6002D is programmed to swap I and Q on the data bus being presented to the FPGA to correct for the flip.

== SMA Connectors ==

There are 10 SMA connectors on the XB-200. Below are brief descriptions of each.

<u>RX</u> 
* <b>RXIF</b> (<i>J3</i>): RX Intermediate Frequency. Connect this to the bladeRF RX port (<i>J53</i>) via an SMA cable.
* <b>RXANT</b> (<i>J12</i>): RX Input. Connect an antenna here.
* <b>RXFILT</b> (<i>J8</i>): Mixer-side of the RX custom filter path. Connect this directly to <b>RXFILT-ANT</b> to use no filter, or connect this to one end of your custom filter, and the other end of your filter to <b>RXFILT-ANT</b>.
* <b>RXFILT-ANT</b> (<i>J9</i>): Antenna-side of the RX custom filter path.
* <b>ADC</b> (<i>J14</i>): This SMA exposes the direct ADC sampling path (skipping the LMS6002). This can also be accessed without the XB-200 via <i>J61</i> on the bladeRF.

<u>TX</u>
* <b>TXIF</b> (<i>J1</i>): TX Intermediate Frequency. Connect this to the bladeRF TX port (<i>J54</i>) via an SMA cable.
* <b>TXANT</b> (<i>J2</i>): TX output. Connect an antenna here. When not transmitting, it is recommended to keep a dummy load or attenuator on this port.
* <b>TXFILT</b> (<i>J11</i>): Mixer-side of the TX custom filter path. Connect this directly to <b>TXFILT-ANT</b> to use no filter, or connect this to one end of your custom filter, and the other end of your filter to <b>TXFILT-ANT</b>.
* <b>TXFILT-ANT</b> (<i>J10</i>): Antenna-side of the TX custom filter path.
* <b>DAC</b> (<i>J15</i>): This SMA exposes the DAC direct sampling path (skipping the LMS6002). This can also be accessed without the XB-200 via <i>J60</i> on the bladeRF.

== GPIO ports ==

GPIO pins are exposed on the XB-200 via <b>J1</b>, <b>J13</b>, and <b>J16</b>. libbladeRF API calls to manipulate these pins are a work in progress.

<b>TO DO:</b> provide jumper pinout and FPGA pin associations. 


= Software Support =

This section is intended to provide information regarding support for the XB-200 in various pieces of software.  Please keep libbladeRF first, but feel free to add or stub out programs you'd like to see more information for.

== libbladeRF ==

The general procedure for using the XB-200 programmatically, via libbladeRF is as follows:
* With an open device handle, enable support for the XB-200 via: <br>[https://github.com/Nuand/bladeRF/blob/15340770ca59d30b82109ad8670aa0fe027ca9fe/host/libraries/libbladeRF/include/libbladeRF.h#L980 bladerf_expansion_attach(dev, BLADERF_XB_200)]
* Select the desired filter bank for the RX and TX paths. For example, to configure the RX module to use the 149-159MHz filter: <br>[https://github.com/Nuand/bladeRF/blob/15340770ca59d30b82109ad8670aa0fe027ca9fe/host/libraries/libbladeRF/include/libbladeRF.h#L1012 bladerf_xb200_set_filterbank(dev, BLADERF_MODULE_RX, BLADERF_XB200_144M)]
** See the [https://github.com/Nuand/bladeRF/blob/15340770ca59d30b82109ad8670aa0fe027ca9fe/host/libraries/libbladeRF/include/libbladeRF.h#L492 bladerf_xb200_filter] enumeration for other options.
* Specify that the XB-200 mixer path should be used: <br>[https://github.com/Nuand/bladeRF/blob/15340770ca59d30b82109ad8670aa0fe027ca9fe/host/libraries/libbladeRF/include/libbladeRF.h#L1041 bladerf_xb200_set_path(dev, BLADERF_MODULE_RX, BLADERF_XB200_MIX)]
** To tune to the "normal" bladeRF ranges, bypass the XB-200 mixer by using the [https://github.com/Nuand/bladeRF/blob/15340770ca59d30b82109ad8670aa0fe027ca9fe/host/libraries/libbladeRF/include/libbladeRF.h#L498 BLADERF_XB200_BYPASS] value with the above function.

== bladeRF-cli ==
To tell the CLI that the XB-200 has been attached, simply run the command <code>xb attach 200</code>.  This will expand the frequency range that the board is able to tune.

At this time, the filterbank selection is not easily changed in the CLI.  The <code>set xb_gpio</code> command has to be used to manually select the filterbank and there is no current way to automatically follow the tuned frequency.

== gr-osmosdr ==
As of commit [http://cgit.osmocom.org/gr-osmosdr/commit/?id=9cb023b00a36d04ad8ea7e0bf08ad0623ab3e95f 9cb023], gr-osmosdr supports natively the XB-200.  Note that the way to enable the board has changed slightly from the previous patched method, so be sure to read the next section very carefully and make appropriate modifications to the device string.

=== Enabling the XB-200 and Selecting Filters ===
To enable the XB200 in software that utilizes gr-osmosdr, add '''xb200''' to the source/sink arguments string. By default, the filter bank selected will automatically tune with the tuned frequency at the 1dB points. Therefore, you must have the <b>FILT</b> and <b>FILT-ANT</b> connected through a filter, or directly connected together (no filter).

If you wish to select one of the other filter paths, append one of the following to the source/sink arguments string:
* <code>xb200=50M</code>
* <code>xb200=144M</code>
* <code>xb200=222M</code>
* <code>xb200=auto</code>
** This option will select an appropriate filter path based upon the selected center frequency with 1dB corners.  This is the default if no filter is selected.
* <code>xb200=auto3db</code>
** This option will select an appropriate file path based upon the selected center frequency with 3dB corners.
* <code>xb200=custom</code>
<br>
Below is an example device string that enables the XB-200 and selects the 144MHz - 148MHz filter:
<pre>
bladerf=0,xb200=144M
</pre>

== GQRX ==
As this utilized gr-osmosdr, you can simply follow the information in the previous section

== SDR# ==
TODO - Efforts to integrate XB-200 support are ongoing. Add links to official support here when it's available.

== SDR-Radio ==
TODO - Efforts to integrate XB-200 support are ongoing. Add links to official support here when it's available.